// SPDX-License-Identifier: LGPL-3.0-only
pragma solidity >=0.7.0 <0.9.0;

import {Enum} from "@gnosis.pm/safe-contracts/contracts/common/Enum.sol";
import {IERC165} from "@openzeppelin/contracts/utils/introspection/IERC165.sol";

import {IGuard} from "../interfaces/IGuard.sol";

abstract contract BaseGuard is IERC165 {
  function supportsInterface(
    bytes4 interfaceId
  ) external pure override returns (bool) {
    return
      interfaceId == type(IGuard).interfaceId || // 0xe6d7a83a
      interfaceId == type(IERC165).interfaceId; // 0x01ffc9a7
  }

  /// @dev Module transactions only use the first four parameters: to, value, data, and operation.
  /// Module.sol hardcodes the remaining parameters as 0 since they are not used for module transactions.
  /// @notice This interface is used to maintain compatibilty with Gnosis Safe transaction guards.
  function checkTransaction(
    address to,
    uint256 value,
    bytes memory data,
    Enum.Operation operation,
    uint256 safeTxGas,
    uint256 baseGas,
    uint256 gasPrice,
    address gasToken,
    address payable refundReceiver,
    bytes memory signatures,
    address msgSender
  ) external virtual;

  function checkAfterExecution(bytes32 txHash, bool success) external virtual;
}
